# J\_IE {#concept_mjf_wl5_zdb .concept}

此函数需要配合码栈控件抓取工具使用，对IE控件以及Windows控件进行一系列操作。

-   IE操作
    -   点击、模拟点击、弹出框点击、模拟弹出框点击、模拟输入、输入；
    -   文件、保存文件、下拉、模糊下拉、正则下拉、获取文本、获取代码、获取坐标、获取对象、获取值、勾选、取消勾选、等待加载、是否勾选；
    -   注意获取坐标返回的是一个长度为5的坐标数组\[0\]全部\[1\]x1\[2\]y1\[3\]x2\[4\]y2。
-   WIN32操作：点击、模拟点击、输入、模拟输入、移动、检测窗口、关闭窗口、强行关闭窗口、获取句柄。

    **说明：** 如果是点击按钮后会有弹出框，那么请用弹出框点击。


## 函数 {#section_jn5_yl5_zdb .section}

J\_IE \(MAP名称,控件名称,操作,\[值\],\[目标窗口\]\)

## 返回值 {#section_udc_zl5_zdb .section}

-   当操作为：点击、模拟点击、弹出框点击、模拟弹出框点击、模拟输入、输入、文件、下拉、模糊下拉、正则下拉、勾选、取消勾选、检测窗口、关闭窗口、强行关闭窗口的时候，成功返回1，失败返回0；
-   当操作为：获取文本的时候返回值为控件文本。
-   当操作位：获取代码的时候返回值为控件内部代码。

## 样例 {#section_srj_zl5_zdb .section}

```

Func Example22()
;新建一个IE窗口并打开www.crm.admin.com链接,声明一个名为$ie的局域变量，装入这个新创建浏览器的对象
Local $ie = J_IE_Create("www.crm.admin.com")
;普通输入操作，成功返回1，失败返回0
Local $res1 = J_IE("CRM", "登录输入框", "输入", "镖头", $ie)
;模拟鼠标键盘进行操作，成功返回1，失败返回0
Local $res2 = J_IE("CRM", "密码输入框", "模拟输入", "镖头", $ie)
;普通点击按钮操作，因为不需要输入数据，所以值参数用“”表示不要输入，成功返回1，失败返回0
Local $res3 = J_IE("CRM", "登录按钮", "点击", "", $ie)
;模拟鼠标点击按钮操作，因为不需要输入数据，所以值参数用“”表示不要输入，成功返回1，失败返回0
Local $res4 = J_IE("CRM", "刷新", "模拟点击", "", $ie)
;在显示区域读取里面可见文本，返回文本
Local $res5 = J_IE("CRM", "显示区域", "获取文本", "", $ie)
;获取文本框用户输入的信息，返回文本
Local $res6 = J_IE("CRM", "输入框", "获取值", "", $ie)
;对于页面复选框进行勾选操作，成功返回1，失败返回0
Local $res7 = J_IE("CRM", "复选框", "勾选", "", $ie)
;获取页面勾选框的状态，勾选状态返回1，未勾选返回0
Local $res8 = J_IE("CRM", "复选框", "是否勾选", "", $ie)
;下拉列表操作，成功返回1，失败返回0
Local $res9 = J_IE("CRM", "小二选择", "下拉", "镖头", $ie)
;通过部分关键字进行下拉列表动作，成功返回1，失败返回0
Local $res10 = J_IE("CRM", "小二选择", "模糊下拉", "镖", $ie)
;上传文件控件操作，成功返回1失败返回0
Local $res11 = J_IE("CRM", "文件按钮", "文件", "D:\pic.jpg", $ie)
;等待刷新区域的刷新，刷新完毕返回1
Local $res12 = J_IE("CRM", "刷新区域", "等待加载", "", $ie)
;点击页面上的控件会弹出提示框是否确认信息，本功能会自动化点击弹出框的确认按钮，成功返回1，失败返回0
Local $res13 = J_IE("CRM", "提交", "弹出框点击", "", $ie)
;模拟鼠标点击页面上的控件会弹出提示框是否确认信息，本功能会自动化点击弹出框的确认按钮，成功返回1，失败返回0
Local $res14 = J_IE("CRM", "提交", "模拟弹出框点击", "", $ie)
;对WIN控件输入，不需要指定窗体，成功返回1，失败返回0
Local $res15 = J_IE("旺旺", "旺旺输入框", "输入", "你好")
;对WIN控件模拟键盘输入操作，不需要指定窗体，成功返回1，失败返回0
Local $res16 = J_IE("旺旺", "旺旺输入框", "模拟输入", "你好")
;对WIN控件点击操作，不需要指定窗体，成功返回1，失败返回0
Local $res17 = J_IE("旺旺", "发送按钮", "点击", "")
;对WIN控件模拟鼠标点击操作，不需要指定窗体，成功返回1，失败返回0
Local $res18 = J_IE("旺旺", "发送按钮", "模拟点击", "")
;获取WIN控件句柄，成功返回控件句柄，失败返回0
Local $res19 = J_IE("旺旺", "旺旺控件", "获取句柄", "")
;关闭WIN控件所在的窗口，成功返回1，失败返回0
Local $res20 = J_IE("旺旺", "旺旺控件", "关闭窗口", "")
;J_IE和J_IE_EXP的区别，前者是对页面唯一的控件进行操作，第二个是对页面多个相同的控件指定位置进行操作，其它功能完全相同
;比如下面两个功能是相同的
;普通输入操作，成功返回1，失败返回0
Local $res1 = J_IE("CRM", "登录输入框", "输入", "镖头", $ie)
Local $res1 = J_IE_EXP("CRM", "登录输入框", 1, "输入", "镖头", $ie);对第一个此属性的控件进行操作
;声明 $max的一个局域变量，在$ie变量中对应的浏览器页面中检索，对应的控件相同属性的在页面中一共有多少个，并保存至$max变量中
;一般情况下用于循环或者判断
Local $max = J_IE_EXP_MaxCount($ie, "CRM", "登录输入框")
EndFunc ;==>Example22
```

